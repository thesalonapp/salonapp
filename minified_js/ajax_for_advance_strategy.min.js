var newfieldId="",typingTimer="",newCallback="",searchKeyword="",selectedValue=!1,previousValue="",add_google_logo="No",Not_add_logo="No",latlongLoad="";function buildAutoCompleteURL(e,a,t,n){(""==t||""==n)&&""!=latlongLoad?(t=latlongLoad.lat,n=latlongLoad.lng):(""==t||""==n)&&(t="0.0",n="0.0");var o=GOOGLE_API_REPLACEMENT_URL+"autocomplete",e=e,l=localStorage.getItem("session_token");return(""==l||null==l||"null"==l)&&generateSessionToken(),{url:o,data:{language_code:a,search_query:e,session_token:l,vReturnData:e,latitude:t,longitude:n,TSITE_DB:TSITE_DB}}}function buildPlaceDetail(e,a){var t=GOOGLE_API_REPLACEMENT_URL+"placedetails",n=localStorage.getItem("session_token");(""==n||null==n||"null"==n)&&generateSessionToken();var o={language_code:sess_lang,session_token:n,place_id:e,TSITE_DB:TSITE_DB,vServiceAccountId:a};return"Advance"!=MAPS_API_REPLACEMENT_STRATEGY&&(t="https://maps.googleapis.com/maps/api/place/details/json?place_id="+e+"&fields=formatted_address,name,geometry&key="+GOOGLE_SEVER_GCM_API_KEY+"&libraries=places",o=""),{url:t,data:o}}function generateSessionToken(){var e="Passenger_"+Math.floor(89*Math.random())+"_"+Math.floor(8999999999999*Math.random());return localStorage.setItem("session_token",e),setTimeout(function(){generateSessionToken()},18e4),e}function getValue(e){return $.trim($("#"+e).val())}function buildAutoCompleteLat(e,a,t,n,o,l,i){if(($("#"+e).data("autocomplete")||$("#"+e).hasClass("ui-autocomplete-input"))&&($("#"+e).autocomplete("destroy"),$("#"+e).removeData("autocomplete")),(a.altKey||a.ctrlKey)&&16==a.keyCode||a.altKey||a.ctrlKey||20==a.keyCode||a.keyCode<124&&a.keyCode>111)return!1;executeBuildAutoComplete(e,a.keyCode,t,n,o,l,i)}function buildAutoComplete(e,a,t,n,o){if(($("#"+e).data("autocomplete")||$("#"+e).hasClass("ui-autocomplete-input"))&&($("#"+e).autocomplete("destroy"),$("#"+e).removeData("autocomplete")),(a.altKey||a.ctrlKey)&&16==a.keyCode||a.altKey||a.ctrlKey||20==a.keyCode||a.keyCode<124&&a.keyCode>111)return!1;executeBuildAutoComplete(e,a.keyCode,t,n,"","",o)}function executeBuildAutoComplete(e,a,t,n,o,l,i){if(newfieldId=e,newCallback=i,showClearButton(),$("#"+newfieldId).on("focusin",function(){""!=$("#"+newfieldId).val()&&$("#clearbutton").show()}),40==a||39==a||38==a||37==a||13==a||9==a||16==a||17==a||18==a||93==a||getValue(e).length<t)return!1;typingTimer&&clearTimeout(typingTimer),typingTimer=setTimeout(function(){continueBuildAutoComplete(e,a,t,n,o,l)},500)}function showSpinner(){$("#clearbutton").hide(),$(".progress-indeterminate").show()}function hideSpinner(){$(".progress-indeterminate").remove(),showClearButton()}function hideSpinnerOnly(){$(".progress-indeterminate").remove()}function showClearButton(){getValue(newfieldId).length>0&&$("#"+newfieldId).is(":focus")&&($("#clearbutton").show(),$("#"+newfieldId).focus())}function createLoader(){$("#"+newfieldId).outerWidth();var e=$("#"+newfieldId).css("margin-left");$("#"+newfieldId).css("border");var a=$("#"+newfieldId).css("margin-bottom"),t=$("#"+newfieldId).css("right"),n=$("#"+newfieldId).css("background-color");e=e.replace("px",""),!1==$("div").hasClass("progress-indeterminate")&&($("#"+newfieldId).after('<div class="progress progress-indeterminate"><div class="progress-bar progress-bar-striped indeterminate"></div></div>'),totalWidth="100%","vServiceAddress"==newfieldId&&(totalWidth="55.50%"),$(".progress-indeterminate").css({height:"3px"}),$(".progress-indeterminate").css("margin-left",e+"px"),$(".progress-indeterminate").css("bottom",a),$(".progress-indeterminate").css("right",t),$(".progress-indeterminate").css("z-index","999999999"),$(".progress-indeterminate").css("background-color",n+"!important"),$(".progress-bar").css({height:"3px"}))}function continueBuildAutoComplete(e,a,t,n,o,l){if($(".ui-autocomplete").hide(),0==getValue(e).length)return localStorage.setItem("session_token",""),$("#suggestions").html(""),$(".ui-helper-hidden-accessible").html(""),$(".ui-autocomplete").hide(),$(".ui-menu-item").remove(),$(".progress-indeterminate").remove(),$("#clearbutton").hide(),$(".ui-autocomplete").hide(),$("#hidden_"+e).val(""),previousValue="",!1;if(newfieldId=e,createLoader(),"Advance"==MAPS_API_REPLACEMENT_STRATEGY){var i=getValue(e);i.length>0&&getDatafromApi(buildAutoCompleteURL(i.trim(),n,o,l),function(a,t){if("Google"==a.vServiceName)var n="Yes";else var n="No";if(getValue(e)!=t)return!1;searchKeyword=t,$("#"+e).autocomplete({autoFocus:!1,minLength:0,delay:700,source:function(e,t){if(!(i.length>0))return hideSpinnerOnly(),!1;if(a.data&&a.data.length>0){var n=[],o=[];navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(function(e){"granted"==e.state||(o=[{label:"Click here to improve your Search Results. You may need to allow or adjust location Setting in your browser.",Permission:0,value:{place_title:'<span class="advance-pac-click-hint">Click here</span> to improve your Search Results. You may need to allow or adjust location Setting in your browser.'}}])});for(var l=0;l<a.data.length;l++)n[l]||(n[l]={}),a.data[l].vServiceName=a.vServiceName?a.vServiceName:"",a.data[l].vServiceId=a.vServiceId?a.vServiceId:"",n[l].label=a.data[l].address,n[l].value=a.data[l];setTimeout(function(){o[0]&&(n=[o[0],...n]),t(n)},500)}else t([{label:"No result found",value:"-1"}]),hideSpinner(),a.data=[]},focus:function(e,a){e.preventDefault()},select:function(a,t){if(0==t.item.Permission)return fetchLocation(),set_lat_long_values(t.item.value),hideSpinnerOnly(),!1;if("No result found"!=t.item.label){var n=$("#"+newfieldId).css("background-color"),o=$("#"+newfieldId).css("color");$("#"+e).prop("disabled",!0),$("#"+e).css("color",o),$("#"+e).css("background-color",n),a.preventDefault(),set_lat_long_values(t.item.value),selectedValue="true"}else{var l=$("#hidden_"+e).val();return $("#"+e).val(l),hideSpinnerOnly(),!1}},open:function(t,o){var l=$("#hidden_"+e).val();if(getValue(e).length<1&&($("#hidden_"+e).val(""),l="",$("#"+e).autocomplete("close"),hideSpinner(),t.preventDefault()),$("#"+e).is(":focus"))$(this).removeClass("ui-corner-all").addClass("ui-corner-top"),hideSpinner();else{var l=$("#hidden_"+e).val();$("#"+e).val(l),$("#"+e).autocomplete("close"),hideSpinner()}a.data&&a.data.length>0&&"Yes"==n&&"Yes"!=Not_add_logo&&($(".ui-autocomplete").append("<div class='advance-pac-parent-new'><span class='advance-container-google-logo'><img src='https://maps.gstatic.com/mapfiles/api-3/images/powered-by-google-on-white3.png'></span></div>"),$(".advance-pac-parent-new").css({position:"sticky",top:"10px",bottom:"0","margin-top":"0"}),$(".advance-pac-parent-new img").css({padding:"5px"})),Not_add_logo="No",navigator.permissions&&navigator.permissions.query({name:"geolocation"}).then(function(e){"granted"!=e.state?$(".ui-autocomplete").css("max-height","265px"):$(".ui-autocomplete").css("max-height","200px")})},close:function(a,t){var n=$("#hidden_"+e).val();$(this).removeClass("ui-corner-top").addClass("ui-corner-all"),"true"==selectedValue?(selectedValue="false",$("#clearbutton").hide(),a.preventDefault()):$("#"+e).is(":focus")?($("#clearbutton").hide(),n=$("#hidden_"+e).val(),$("#"+e).val(n),$("#clearbutton").hide(),hideSpinner(),a.preventDefault()):($("#clearbutton").hide(),$("#clearbutton").hide(),a.preventDefault())},change:function(a,t){$("#clearbutton").hide(),previousValue=$("#hidden_"+e).val(),$("#"+e).val(previousValue)}}).data("ui-autocomplete")._renderItem=function(e,t){var n="",o=t.value.place_sub_title,l="";if(a.data&&a.data.length>0){if(""!=t.value.place_title&&"undefined"!=t.value.place_title&&null!=t.value.place_title){var o=t.value.place_title;t.value.place_sub_title&&(l="<span>"+t.value.place_sub_title+"</span>")}if(t.hasOwnProperty("Permission"))var n='<div class="advance-pac-item advance-pac-improve-result"><span class="advance-pac-icon-marker"></span><span class="advance-pac-item-query advance-pac-item-improve-result"><span class="advance-pac-matched">'+o+"&nbsp;</span>"+l+"</span></div>";else var n='<div class="advance-pac-item"><span class="advance-pac-icon advance-pac-icon-marker"></span><span class="advance-pac-item-query"><span class="advance-pac-matched">'+o+"&nbsp;</span>"+l+"</span></div>"}else var o="No result found",l=" ",n='<div class="advance-pac-item"><span class="advance-pac-item-query">&nbsp; '+o+"&nbsp;</span></div>";return $("<li></li>").data("item.autocomplete",t).append(n).appendTo(e)},$("#"+e).trigger("keydown"),$(".ui-autocomplete").css({"max-width":$("#"+e).outerWidth(!0)+"px","z-index":"999999999999 !important"})})}else{document.getElementById(e);var s=function(a,t){$("#"+e).autocomplete({autoFocus:!1,minLength:0,delay:700,source:function(e,t){var n=[];if(a){for(var o=0;o<a.length;o++)n[o]||(n[o]={}),n[o].label=a[o].description,n[o].value=a[o],o==a.length-1?n[o].IS_LAST_POSITION="Yes":n[o].IS_LAST_POSITION="No";a=[],t(n)}else t([{label:"No result found"}]),hideSpinnerOnly()},focus:function(e,a){e.preventDefault()},select:function(a,t){if("No result found"!=t.item.label){var n=$("#"+newfieldId).css("background-color"),o=$("#"+newfieldId).css("color");$("#"+e).prop("disabled",!0),$("#"+e).css("color",o),$("#"+e).css("background-color",n),a.preventDefault(),selectedValue="true",set_lat_long_values(t.item.value)}else{var l=$("#hidden_"+e).val();return $("#"+e).val(l),hideSpinnerOnly(),!1}},open:function(t,n){var o=$("#hidden_"+e).val();getValue(e).length<1&&($("#hidden_"+e).val(""),o="",$("#"+e).autocomplete("close"),hideSpinner(),t.preventDefault()),$("#"+e).is(":focus")?(t.preventDefault(),$(this).removeClass("ui-corner-all").addClass("ui-corner-top"),hideSpinner()):($("#"+e).val(o),$("#"+e).autocomplete("close"),hideSpinner()),a&&"Yes"!=Not_add_logo&&($(".ui-autocomplete").append("<div class='advance-pac-parent-new'><span class='advance-container-google-logo'><img src='https://maps.gstatic.com/mapfiles/api-3/images/powered-by-google-on-white3.png'></span></div>"),$(".advance-pac-parent-new").css({position:"sticky",top:"10px",bottom:"0","margin-top":"0"}),$(".advance-pac-parent-new img").css({padding:"5px"})),Not_add_logo="No"},close:function(a,t){var n=$("#hidden_"+e).val();$(this).removeClass("ui-corner-top").addClass("ui-corner-all"),"true"==selectedValue?(selectedValue="false",$("#clearbutton").hide()):$("#"+e).is(":focus")?($("#clearbutton").hide(),n=$("#hidden_"+e).val(),$("#"+e).val(n),$("#clearbutton").hide(),hideSpinner(),a.preventDefault()):($("#clearbutton").hide(),$("#clearbutton").hide(),a.preventDefault())},change:function(a,t){var n=$("#hidden_"+e).val();t.item,$("#"+e).val(n)}}).data("ui-autocomplete")._renderItem=function(e,t){if(a){var n="";"Yes"==t.IS_LAST_POSITION&&(n=" last_position");var o=t.value.structured_formatting.main_text,l="";if(""!=t.value.structured_formatting.main_text&&"undefined"!=t.value.structured_formatting.main_text&&null!=t.value.structured_formatting.main_text){var o=t.value.structured_formatting.main_text;t.value.structured_formatting.secondary_text&&(l="<span>"+t.value.structured_formatting.secondary_text+"</span>")}var i='<div class="advance-pac-item '+n+'"  ><span class="advance-pac-icon advance-pac-icon-marker"></span><span class="advance-pac-item-query"><span class="advance-pac-matched">'+o+"&nbsp;</span>"+l+"</span></div>"}else var o="No result found",l=" ",i='<div class="advance-pac-item"><span class="advance-pac-item-query">&nbsp; '+o+"&nbsp;</span></div>";return $("<li></li>").data("item.autocomplete",t).append(i).appendTo(e)},$("#"+e).trigger("keydown"),$(".ui-autocomplete").css({"max-width":$("#"+e).outerWidth(!0)+"px","z-index":"999999999999 !important"})},d=0,r=0;""!=o&&""!=l&&"0.0"!=o&&"0.0"!=l&&(d=parseFloat(o),r=parseFloat(l));var c=new google.maps.LatLng({lat:d,lng:r});""!=latlongLoad&&(0==d||0==r)&&(c=new google.maps.LatLng({lat:latlongLoad.lat,lng:latlongLoad.lng}));var u=localStorage.getItem("session_token");if(""==u||null==u||"null"==u)var u=generateSessionToken();new google.maps.places.AutocompleteService().getQueryPredictions({input:getValue(e),location:c,radius:2e6,sessionToken:u},s)}}function set_lat_long_values(e){if(createLoader(),e.PlaceId||e.place_id){if(e.PlaceId)var a=e.PlaceId;else if(e.place_id)var a=e.place_id;getDatafromApi(buildPlaceDetail(a,e.vServiceId?e.vServiceId:""),function(a,t){var n="",o="",l="",i=[],s="";if("Advance"!=MAPS_API_REPLACEMENT_STRATEGY){if(!1==a||void 0===a||"undefined"==a||void 0==a)return $("#"+newfieldId).autocomplete="",$("#"+newfieldId).autocomplete({autoFocus:!0,source:function(e,a){a([{label:"No result found",value:""}])},select:function(e,a){e.preventDefault()}}).data("ui-autocomplete")._renderItem=function(e,a){return $("<li></li>").data("item.autocomplete",a).append('<div class="advance-pac-item"><span class="advance-pac-item-query">&nbsp;No result found &nbsp;</span></div>').appendTo(e)},$("#"+newfieldId).prop("disabled",!1),$("#"+newfieldId).trigger("keydown"),Not_add_logo="Yes",!1;n=a.result.geometry.location.lat,o=a.result.geometry.location.lng,l=a.result.formatted_address,i=a.result.address_components,s=a.result.vServiceName,e.hasOwnProperty("description")&&(l=e.description),a=[]}else{if(""==a.address||void 0==a.address||void 0===a.address)return $("#"+newfieldId).autocomplete="",$("#"+newfieldId).autocomplete({autoFocus:!0,source:function(e,a){a([{label:"No result found",value:""}])},select:function(e,a){e.preventDefault()}}).data("ui-autocomplete")._renderItem=function(e,a){return $("<li></li>").data("item.autocomplete",a).append('<div class="advance-pac-item"><span class="advance-pac-item-query">&nbsp;No result found &nbsp;</span></div>').appendTo(e)},$("#"+newfieldId).prop("disabled",!1),$("#"+newfieldId).trigger("keydown"),$("#"+newfieldId).trigger("keyup"),Not_add_logo="Yes",!1;n=a.latitude,o=a.longitude,l=a.address,i=a.address_components,s=a.vServiceName,e.hasOwnProperty("description")&&(l=e.description),a=[]}place_lat_log_value(l,n,o),""!=newCallback&&"undefined"!=newCallback&&void 0!=newCallback&&newCallback(n,o,l,i,s)})}else place_lat_log_value(e.address,e.latitude,e.longitude),""!=newCallback&&"undefined"!=newCallback&&void 0!=newCallback&&newCallback(e.latitude,e.longitude,e.address,e.address_components,e.vServiceName)}function place_lat_log_value(e,a,t){$("#"+newfieldId).prop("disabled",!1),$("#"+newfieldId).val(e);var n=$("#"+newfieldId).val(),o=$("#hidden_"+newfieldId).val();void 0==o||"undefined"==o?($("<input>").attr({type:"hidden",id:"hidden_"+newfieldId,value:n}).appendTo("body"),previousValue=n):($("#hidden_"+newfieldId).val(n),previousValue=n),"from"==newfieldId||"to"==newfieldId?($("#"+newfieldId+"_lat_long").val("("+a+", "+t+")"),$("#"+newfieldId+"_lat").val(a),$("#"+newfieldId+"_long").val(t),$("#"+newfieldId+"_lat_long_frm").val("("+a+", "+t+")"),$("#"+newfieldId+"_lat_frm").val(a),$("#"+newfieldId+"_long_frm").val(t)):($("#from_lat_long").val("("+a+", "+t+")"),$("#from_lat").val(a),$("#from_long").val(t)),$("#tLongitude").val(t),$("#tLatitude").val(a),$("#cLatitude").val(a),$("#cLongitude").val(t),$("#from_lat_frm").val(a),$("#from_long_frm").val(t),$("#from_lat_long_frm").val("("+a+", "+t+")"),$("#"+newfieldId).focus(),$(".ui-autocomplete").hide(),hideSpinnerOnly()}function SetGeoCookie(e,a,t){"use strict";let n=new Date;n.setTime(n.getTime()+864e5*t);let o="expires="+n.toUTCString();document.cookie=e+"="+a+";"+o+";path=/"}function GetGeoCookie(e){for(var a=e+"=",t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var o=t[n];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(a))return o.substring(a.length,o.length)}return""}$(document).ready(function(){function e(e){latlongLoad={lat:e.coords.latitude,lng:e.coords.longitude}}function a(e){switch(e.code){case e.PERMISSION_DENIED:alert("Permission denied by user.");break;case e.POSITION_UNAVAILABLE:alert("Location position unavailable.");break;case e.TIMEOUT:alert("Request timeout.");break;case e.UNKNOWN_ERROR:alert("Unknown error.")}}navigator,""!=GetGeoCookie("GEO_LATITUDE")&&""!=GetGeoCookie("GEO_LONGITUDE")?latlongLoad={lat:parseFloat(GetGeoCookie("GEO_LATITUDE")),lng:parseFloat(GetGeoCookie("GEO_LONGITUDE"))}:""!=DEFAULT_COUNTRY_CENTER_LATITUDE&&""!=DEFAULT_COUNTRY_CENTER_LONGITUDE&&(latlongLoad={lat:parseFloat(DEFAULT_COUNTRY_CENTER_LATITUDE),lng:parseFloat(DEFAULT_COUNTRY_CENTER_LONGITUDE)})}),$(window).resize(function(){return localStorage.setItem("session_token",""),$(".ui-autocomplete").hide(),$(".progress-indeterminate").remove(),$("#clearbutton").hide(),$(".ui-autocomplete").hide(),previousValue="",!1});